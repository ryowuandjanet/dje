{% extends 'store/layouts/main.html' %}

{% block content %}
  
  <div class="py-3 bg-primary">
    <div class="container">
      <a href="{% url 'home' %}" class="text-white">首頁 /</a>
      <a href="{% url 'myorders' %}" class="text-white">我的訂單</a>
    </div>
  </div>

  <div class="container my-3">
    <div class="row">
      <div class="col-md-12">
        <div class="card shadow">
          <div class="card-header">
            <h3 class="mb-0">訂單查看
              <a href="{% url 'myorders' %}" class="btn btn-warning float-end text-dark fw-semibold"><i class="fa-solid fa-reply"></i> 返回</a>
            </h3>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-4">
                <h4>貨運明細</h4>
                <hr>
                <label class="mt-1 fw-semibold">個人姓名(或公司行號)</label>
                <div class="border p-1">{{ order.fname }}</div>
                <label class="mt-3 fw-semibold">統一編號 {% if not order.uniNumber %} <small class="text-white bg-dark">(未輸入)</small>{% endif %}</label>
                <div class="border p-1">{{ order.uniNumber }}</div>
                <label class="mt-3 fw-semibold">電子郵件</label>
                <div class="border p-1">{{ order.email }}</div>
                <label class="mt-3 fw-semibold">手機(或連絡電話)</label>
                <div class="border p-1">{{ order.phone }}</div>
                <label class="mt-3 fw-semibold">貨運住址</label>
                <div class="border p-1">
                  {% if order.pincode %}{{ order.pincode }}{% endif %}
                  {% if order.city %}{{ order.city }}{% endif %}
                  {% if order.address %}{{ order.address }}{% endif %}
                </div>

              </div>
              <div class="col-md-8">
                <h4>訂單詳細信息</h4>
                <hr>
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th>圖示</th>
                      <th>商品名稱</th>
                      <th>數量</th>
                      <th>單價</th>
                      <th>合計</th>
                      <th>備註</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for item in orderitems %}
                      <tr>
                        <td>
                          <img src="{{ item.product.product_image }}" height="50px" width="50px" alt="Product Image">
                        </td>
                        <td>{{ item.product.name }}</td>
                        <td>{{ item.quantity }}</td>
                        {% if item.quantity >= 100 %}
                          <td>{{ item.product.selling_price|stringformat:'d' }}</td>
                        {% else %}
                          <td>{{ item.product.original_price|stringformat:'d' }}</td>
                        {% endif %}
                        <td>
                          {{ item.getOrderSingleItemPrice|stringformat:'d' }}
                        </td>
                        <td>{{ item.remark|linebreaks|default:"" }}</td>
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>

                <h4> 
                  總計 : 
                  <span class="float-end">
                    {% if order.uniNumber %}(含稅 5%){% else %}(未稅){% endif %}
                    新台幣 {{ order.total_price|stringformat:'d' }}元
                  </span>
                </h4>

                <h6 class="border p-2">
                  <div class="fs-4 fw-semibold">付款資訊：</div>
                  <div class="fs-5 mx-2 mt-1 text-danger fw-semibold">
                    <div>銀行：中國信託822</div>
                    <div>帳戶：0000440540133819</div>
                    <div>戶名：王建斌</div>
                  </div>

                </h6>
                <h6 class="border p-2">訂單狀態 : {{ order.status }}</h6>
                <h6 class="border p-2">追蹤號碼 : {{ order.tracking_no }}</h6>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  {% for item in orders %}
    {{ item.tracking_no }}
  {% endfor %}
{% endblock content %}